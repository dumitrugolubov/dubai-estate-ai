import { createContext, useContext, useState, useEffect } from 'react'

const translations = {
  ru: {
    appName: 'DubaiEstate AI',
    subtitle: 'Ğ”Ğ»Ñ Ñ€Ğ¸ÑĞ»Ñ‚Ğ¾Ñ€Ğ¾Ğ² Ğ”ÑƒĞ±Ğ°Ñ',
    greeting: 'ĞŸÑ€Ğ¸Ğ²ĞµÑ‚',
    greetingEnd: 'ğŸ‘‹',
    loading: 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°...',
    newProject: 'ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚',
    projects: 'Ğ’Ğ°ÑˆĞ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹',
    noProjects: 'ĞĞµÑ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ²',
    createFirstProject: 'Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ ÑĞ²Ğ¾Ğ¹ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚, Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ğ² Ñ‡ĞµÑ€Ñ‚ĞµĞ¶ ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ñ‹',
    createProject: 'Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚',
    subscribe: 'ĞÑ„Ğ¾Ñ€Ğ¼Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºÑƒ',
    login: 'Ğ’Ğ¾Ğ¹Ñ‚Ğ¸',
    features: 'Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸',
    pricing: 'ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°',
    perMonth: '/Ğ¼ĞµÑ',
    bestChoice: 'Ğ›ÑƒÑ‡ÑˆĞ¸Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€',
    cancelAnytime: 'ĞĞ¿Ğ»Ğ°Ñ‚Ğ° Ñ‡ĞµÑ€ĞµĞ· Stripe. ĞÑ‚Ğ¼ĞµĞ½Ğ° Ğ² Ğ»ÑĞ±Ğ¾Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚.',
    alreadyHaveAccount: 'Ğ£Ğ¶Ğµ ĞµÑÑ‚ÑŒ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚?',
    premiumActive: 'Premium Ğ°ĞºÑ‚Ğ¸Ğ²ĞµĞ½',
    connectedChannels: 'ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ‹Ğµ ĞºĞ°Ğ½Ğ°Ğ»Ñ‹',
    management: 'Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ',
    subscribers: 'Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸ĞºĞ¾Ğ²',
    totalObjects: 'Ğ’ÑĞµĞ³Ğ¾ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ²',
    rendersCreated: 'Ğ ĞµĞ½Ğ´ĞµÑ€Ğ¾Ğ² ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¾',
    channelConnected: 'ĞĞµÑ‚ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ‹Ñ… ĞºĞ°Ğ½Ğ°Ğ»Ğ¾Ğ²',
    connectChannel: 'ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ ĞºĞ°Ğ½Ğ°Ğ»',
    howToConnect: 'ĞšĞ°Ğº Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ?',
    projectCreated: 'ĞŸÑ€Ğ¾ĞµĞºÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾',
    draftSaved: 'Ğ§ĞµÑ€Ğ½Ğ¾Ğ²Ğ¸Ğº ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½',
    generating: 'Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ...',
    generate: 'Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',
    regenerate: 'ĞŸĞµÑ€ĞµĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',
    copy: 'ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',
    copied: 'Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾!',
    post: 'ĞĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ñ‚ÑŒ',
    chooseChannel: 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ĞºĞ°Ğ½Ğ°Ğ»',
    noChannels: 'ĞĞµÑ‚ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ‹Ñ… ĞºĞ°Ğ½Ğ°Ğ»Ğ¾Ğ²',
    selectChannel: 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ĞºĞ°Ğ½Ğ°Ğ» Ğ´Ğ»Ñ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸',
    published: 'ĞĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ğ½Ğ¾ Ğ² ĞºĞ°Ğ½Ğ°Ğ»!',
    step: 'Ğ¨Ğ°Ğ³',
    from: 'Ğ¸Ğ·',
    continue: 'ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ÑŒ',
    uploadBlueprint: 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚Ğµ Ñ‡ĞµÑ€Ñ‚ĞµĞ¶',
    blueprintDesc: 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚Ğµ Ğ¿Ğ»Ğ°Ğ½ ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ñ‹ Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ 3D Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸',
    dragDrop: 'ĞŸĞµÑ€ĞµÑ‚Ğ°Ñ‰Ğ¸Ñ‚Ğµ Ñ„Ğ°Ğ¹Ğ» ÑÑĞ´Ğ°',
    orClick: 'Ğ¸Ğ»Ğ¸ Ğ½Ğ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ°',
    maxSize: 'ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚: JPG, PNG, PDF (Ğ´Ğ¾ 10 ĞœĞ‘)',
    details: 'ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸',
    detailsDesc: 'Ğ£ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ°',
    propertyType: 'Ğ¢Ğ¸Ğ¿ Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸',
    bedrooms: 'Ğ¡Ğ¿Ğ°Ğ»ÑŒĞ½Ğ¸',
    bathrooms: 'Ğ¡Ğ°Ğ½ÑƒĞ·Ğ»Ñ‹',
    area: 'ĞŸĞ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ',
    sqft: 'ĞºĞ². Ñ„ÑƒÑ‚',
    sqm: 'ĞºĞ². Ğ¼',
    location: 'Ğ Ğ°ÑĞ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ',
    locationDesc: 'Ğ£ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ñ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ°',
    district: 'Ğ Ğ°Ğ¹Ğ¾Ğ½ / Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ¾',
    tower: 'Ğ‘Ğ°ÑˆĞ½Ñ / ĞšĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑ',
    renderStyle: 'Ğ¡Ñ‚Ğ¸Ğ»ÑŒ Ñ€ĞµĞ½Ğ´ĞµÑ€Ğ°',
    price: 'Ğ¦ĞµĞ½Ğ°',
    priceDesc: 'Ğ£ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ Ñ†ĞµĞ½Ñƒ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ°',
    currency: 'Ğ’Ğ°Ğ»ÑÑ‚Ğ°',
    save: 'Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ',
    settings: 'ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸',
    profile: 'ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ',
    channels: 'ĞšĞ°Ğ½Ğ°Ğ»Ñ‹',
    addChannel: 'Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ',
    remove: 'ĞÑ‚ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ',
    botUsername: 'ĞĞ°Ñˆ Ğ±Ğ¾Ñ‚ Ğ´Ğ»Ñ Ğ¿Ğ¾ÑÑ‚Ğ¸Ğ½Ğ³Ğ°:',
    addBotAdmin: 'Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ±Ğ¾Ñ‚Ğ° ĞºĞ°Ğº Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ° Ğ² ĞºĞ°Ğ½Ğ°Ğ» Ğ´Ğ»Ñ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ²',
    language: 'Ğ¯Ğ·Ñ‹Ğº Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°',
    russian: 'Ğ ÑƒÑÑĞºĞ¸Ğ¹',
    english: 'ĞĞ½Ğ³Ğ»Ğ¸Ğ¹ÑĞºĞ¸Ğ¹',
    support: 'ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°',
    telegramChat: 'Telegram Ñ‡Ğ°Ñ‚',
    help: 'ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚Ğµ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒ',
    logout: 'Ğ’Ñ‹Ğ¹Ñ‚Ğ¸ Ğ¸Ğ· Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ°',
    draft: 'Ğ§ĞµÑ€Ñ‚ĞµĞ¶',
    render3d: '3D Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ',
    aiPowered: 'AI Powered',
    modern: 'Ğ¡Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¹',
    luxury: 'Ğ›ÑĞºÑ',
    minimalist: 'ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ¼',
    arabic: 'ĞÑ€Ğ°Ğ±ÑĞºĞ¸Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ',
    scandinavian: 'Ğ¡ĞºĞ°Ğ½Ğ´Ğ¸Ğ½Ğ°Ğ²ÑĞºĞ¸Ğ¹',
    apartment: 'ĞšĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ğ°',
    villa: 'Ğ’Ğ¸Ğ»Ğ»Ğ°',
    penthouse: 'ĞŸĞµĞ½Ñ‚Ñ…Ğ°ÑƒÑ',
    studio: 'Ğ¡Ñ‚ÑƒĞ´Ğ¸Ñ',
    townhouse: 'Ğ¢Ğ°ÑƒĞ½Ñ…Ğ°ÑƒÑ',
    bedroomsOptions: ['Ğ¡Ñ‚ÑƒĞ´Ğ¸Ñ', '1 ÑĞ¿Ğ°Ğ»ÑŒĞ½Ñ', '2 ÑĞ¿Ğ°Ğ»ÑŒĞ½Ğ¸', '3 ÑĞ¿Ğ°Ğ»ÑŒĞ½Ğ¸', '4+ ÑĞ¿Ğ°Ğ»ÑŒĞ½Ğ¸'],
    bathroomsOptions: ['1 ÑĞ°Ğ½ÑƒĞ·ĞµĞ»', '2 ÑĞ°Ğ½ÑƒĞ·Ğ»Ğ°', '3+ ÑĞ°Ğ½ÑƒĞ·Ğ»Ğ°'],
    unlimitedRenders: 'Ğ‘ĞµĞ·Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ğ½Ñ‹Ğµ 3D Ñ€ĞµĞ½Ğ´ĞµÑ€Ñ‹',
    textGeneration: 'Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²',
    autoPosting: 'ĞĞ²Ñ‚Ğ¾Ğ¿Ğ¾ÑÑ‚Ğ¸Ğ½Ğ³ Ğ² ĞºĞ°Ğ½Ğ°Ğ»Ñ‹',
    saveProjects: 'Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞ¹Ñ‚Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹',
    prioritySupport: 'ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ½Ğ°Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°',
    apartmentLower: 'ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ğ°',
    villaLower: 'Ğ²Ğ¸Ğ»Ğ»Ğ°',
    penthouseLower: 'Ğ¿ĞµĞ½Ñ‚Ñ…Ğ°ÑƒÑ',
    studioLower: 'ÑÑ‚ÑƒĞ´Ğ¸Ñ',
    townhouseLower: 'Ñ‚Ğ°ÑƒĞ½Ñ…Ğ°ÑƒÑ',
    bedroomsLower: 'ÑĞ¿.',
    sqftLower: 'ĞºĞ². Ñ„ÑƒÑ‚',
    locationLower: 'Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ñ',
    priceLower: 'Ñ†ĞµĞ½Ğ°',
    description: 'ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ°',
    quickTemplates: 'Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğµ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ñ‹',
    emphasizeView: 'ĞŸĞ¾Ğ´Ñ‡ĞµÑ€ĞºĞ½ÑƒÑ‚ÑŒ Ğ²Ğ¸Ğ´',
    emphasizeRenovation: 'ĞĞºÑ†ĞµĞ½Ñ‚ Ğ½Ğ° Ñ€ĞµĞ¼Ğ¾Ğ½Ñ‚',
    investmentPotential: 'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ†Ğ¸Ğ°Ğ»',
    familyProperty: 'Ğ¡ĞµĞ¼ĞµĞ¹Ğ½Ğ°Ñ Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ'
  },
  en: {
    appName: 'DubaiEstate AI',
    subtitle: 'For Dubai Real Estate Agents',
    greeting: 'Hello',
    greetingEnd: 'ğŸ‘‹',
    loading: 'Loading...',
    newProject: 'New Project',
    projects: 'Your Projects',
    noProjects: 'No Projects',
    createFirstProject: 'Create your first project by uploading a floor plan',
    createProject: 'Create Project',
    subscribe: 'Subscribe',
    login: 'Login',
    features: 'Features',
    pricing: 'Subscription',
    perMonth: '/month',
    bestChoice: 'Best Value',
    cancelAnytime: 'Payment via Stripe. Cancel anytime.',
    alreadyHaveAccount: 'Already have an account?',
    premiumActive: 'Premium Active',
    connectedChannels: 'Connected Channels',
    management: 'Manage',
    subscribers: 'subscribers',
    totalObjects: 'Total Properties',
    rendersCreated: 'Renders Created',
    channelConnected: 'No connected channels',
    connectChannel: 'Connect Channel',
    howToConnect: 'How to connect?',
    projectCreated: 'Project saved locally',
    draftSaved: 'Draft saved',
    generating: 'Generating...',
    generate: 'Generate',
    regenerate: 'Regenerate',
    copy: 'Copy',
    copied: 'Copied!',
    post: 'Post',
    chooseChannel: 'Select Channel',
    noChannels: 'No channels connected',
    selectChannel: 'Select a channel to publish',
    published: 'Posted to channel!',
    step: 'Step',
    from: 'of',
    continue: 'Continue',
    uploadBlueprint: 'Upload Floor Plan',
    blueprintDesc: 'Upload your apartment floor plan to create 3D visualization',
    dragDrop: 'Drop file here',
    orClick: 'or click to select',
    maxSize: 'Supports: JPG, PNG, PDF (up to 10 MB)',
    details: 'Property Details',
    detailsDesc: 'Specify property characteristics',
    propertyType: 'Property Type',
    bedrooms: 'Bedrooms',
    bathrooms: 'Bathrooms',
    area: 'Area',
    sqft: 'sq ft',
    sqm: 'sq m',
    location: 'Location',
    locationDesc: 'Specify property location',
    district: 'District / Community',
    tower: 'Tower / Complex',
    renderStyle: 'Render Style',
    price: 'Price',
    priceDesc: 'Specify property price',
    currency: 'Currency',
    save: 'Save',
    settings: 'Settings',
    profile: 'Profile',
    channels: 'Channels',
    addChannel: 'Add',
    remove: 'Disconnect',
    botUsername: 'Our posting bot:',
    addBotAdmin: 'Add the bot as administrator to your channel to publish listings',
    language: 'Interface Language',
    russian: 'Russian',
    english: 'English',
    support: 'Support',
    telegramChat: 'Telegram Chat',
    help: 'Get Help',
    logout: 'Logout',
    draft: 'Floor Plan',
    render3d: '3D Render',
    aiPowered: 'AI Powered',
    modern: 'Modern',
    luxury: 'Luxury',
    minimalist: 'Minimalist',
    arabic: 'Arabic Style',
    scandinavian: 'Scandinavian',
    apartment: 'Apartment',
    villa: 'Villa',
    penthouse: 'Penthouse',
    studio: 'Studio',
    townhouse: 'Townhouse',
    bedroomsOptions: ['Studio', '1 Bedroom', '2 Bedrooms', '3 Bedrooms', '4+ Bedrooms'],
    bathroomsOptions: ['1 Bathroom', '2 Bathrooms', '3+ Bathrooms'],
    unlimitedRenders: 'Unlimited 3D Renders',
    textGeneration: 'Text Generation',
    autoPosting: 'Auto-posting to Channels',
    saveProjects: 'Save Projects',
    prioritySupport: 'Priority Support',
    apartmentLower: 'apartment',
    villaLower: ' villa',
    penthouseLower: 'penthouse',
    studioLower: 'studio',
    townhouseLower: 'townhouse',
    bedroomsLower: 'bed',
    sqftLower: 'sq ft',
    locationLower: 'location',
    priceLower: 'price',
    description: 'Property Description',
    quickTemplates: 'Quick Templates',
    emphasizeView: 'Emphasize View',
    emphasizeRenovation: 'Highlight Renovation',
    investmentPotential: 'Investment Potential',
    familyProperty: 'Family Property'
  }
}

const LanguageContext = createContext(null)

export const useLanguage = () => {
  const context = useContext(LanguageContext)
  if (!context) throw new Error('useLanguage must be used within LanguageProvider')
  return context
}

export const LanguageProvider = ({ children }) => {
  const [language, setLanguage] = useState('ru')

  useEffect(() => {
    if (typeof window !== 'undefined') {
      const saved = localStorage.getItem('language')
      if (saved && ['ru', 'en'].includes(saved)) {
        setLanguage(saved)
      } else {
        const browserLang = navigator.language?.split('-')[0]
        if (browserLang === 'en') setLanguage('en')
      }
    }
  }, [])

  const changeLanguage = (lang) => {
    setLanguage(lang)
    if (typeof window !== 'undefined') {
      localStorage.setItem('language', lang)
      document.documentElement.lang = lang
      document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr'
    }
  }

  const t = (key) => translations[language][key] || key

  return (
    <LanguageContext.Provider value={{ language, setLanguage: changeLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  )
}
